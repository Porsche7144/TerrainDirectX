// HLSL PixelShader

Texture2D shaderTexture;
SamplerState SampleType;

cbuffer LightBuffer
{
	// 라이트의 색과 방향을 담는 용도
	float4 AmbientColor;  // 주변광
	float4 DiffuseColor;
	float3 LightDirection;
	float Padding;
}

struct PS_INPUT
{
	float4 pos : SV_POSITION;
    float2 tex : TEXCOORD0;
	float3 normal : NORMAL;
};

//////////////////////////////////////////////
//				픽셀 쉐이더                 //
//////////////////////////////////////////////

float4 PS_PixelShader(PS_INPUT input) : SV_TARGET
{

	float4 textureColor;
	float3 LightDir;
	float LightIntensity; // 빛의 조도
	float4 color;

	textureColor = shaderTexture.Sample(SampleType, input.tex);

	// 기본 출력 색상을 모든 픽셀의 AmbientColor 값으로 설정
	color = AmbientColor;

	// 계산을 위해 조명의 방향을 반전시킴
	LightDir = -LightDirection;

	// 픽셀의 빛의 양을 계산.
	// 조도 = 삼각형의 노말벡터와 라이트의 방향 벡터 내적값.
	LightIntensity = saturate(dot(input.normal, LightDir));

	// 노말벡터와 라이트 벡터의 내적값이 0보다 크다면 라이트값을 주변광(AmbientLight)에 더하고
	// 그렇지 않다면 라이트값을 더하지 않도록 한다.
	if(LightIntensity > 0.0f)
	{
		color += (DiffuseColor * LightIntensity);
	}

	// 주변광과 라이트를 더한 결과가 1이 넘을 수 있으므로
	// saturate 함수로 최종 색상이 적절한 값이 되도록 잘라낸다.
	color = saturate(color);
	color = color * textureColor;


	return color;
}